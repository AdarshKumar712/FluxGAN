using Test

include("./mmd.jl")

tol = 1e-5

@testset "mix_rbf_mmd2" begin
    X = [0.4126 0.334]
    Y = [-0.3432 0.45]
    sigma_list = [1.0, 2.0, 4.0, 8.0, 16.0] ./ 1.0
    @test mix_rbf_mmd2(X, Y, sigma_list) == 0.6955453052850462

    X = [-0.9964 1.6757 -1.0000 -0.9621 3.0564; -0.9966 1.6849 -1.0000 -0.9630 3.0814]
    Y = [-0.4433 0.1915 0.2270 0.0989 -0.1531; -0.4603 0.2200 0.1087 0.0844 -0.1827]
    @test mix_rbf_mmd2(X, Y, sigma_list) == 4.754166275960963

    X = [0.0588 24.6208 0.6140 1.9435 21.2479; 0.0780 23.8120 0.5976 1.8904 20.5289]
    Y = [0.2057 18.4525 0.4892 1.5384 15.7635; 0.1529 20.6706 0.5340 1.6841 17.7357]
    @test mix_rbf_mmd2(X, Y, sigma_list) == 4.659662358316032

end;

@testset "_mmd2" begin
    Kₓₓ = [5.0 4.999526869857079; 4.999526869857079 5.0]
    Kₓᵧ = [2.6194483555739208 2.629665928762427; 2.610644548009624 2.6206924815501655]
    Kᵧᵧ = [5.0 4.989256995960984; 4.989256995960984 5.0]
    @test _mmd2(Kₓₓ, Kₓᵧ, Kᵧᵧ) == 4.748558208869993
    @test _mmd2(Kₓₓ, Kₓᵧ, Kᵧᵧ, false, true) == 4.754166275960963
end;
